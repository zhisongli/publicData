(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     14035,        410]
NotebookOptionsPosition[     13130,        386]
NotebookOutlinePosition[     13537,        403]
CellTagsIndexPosition[     13494,        400]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"U", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{"1", ",", "x", ",", "y", ",", "z"}], "]"}], ",", 
      RowBox[{"u", "[", 
       RowBox[{"2", ",", "x", ",", "y", ",", "z"}], "]"}], ",", 
      RowBox[{"u", "[", 
       RowBox[{"3", ",", "x", ",", "y", ",", "z"}], "]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gradU", " ", "=", " ", 
    RowBox[{"Grad", "[", 
     RowBox[{"U", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eigenValueGradU", "=", 
   RowBox[{"Eigenvalues", "[", "gradU", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "eigenValueGradU"}], "//", "Total"}], "//", 
     "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<P = -eigenValueGradU//Total\\n  = \>\"", ",", "P"}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"eigenValueGradU", "[", 
       RowBox[{"[", "1", "]"}], "]"}], 
      RowBox[{"eigenValueGradU", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "+", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"eigenValueGradU", "[", 
       RowBox[{"[", "1", "]"}], "]"}], 
      RowBox[{"eigenValueGradU", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], "+", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"eigenValueGradU", "[", 
       RowBox[{"[", "2", "]"}], "]"}], 
      RowBox[{"eigenValueGradU", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}]}], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QQ1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Tr", "[", 
      RowBox[{"Grad", "[", 
       RowBox[{
        RowBox[{"U", "*", "U"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"Tr", "[", 
       RowBox[{"Grad", "[", 
        RowBox[{"U", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], "]"}], "^", 
      "2"}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.5"}], "#"}], "&"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QQ2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Tr", "[", 
      RowBox[{
       RowBox[{"Grad", "[", 
        RowBox[{"U", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], "^", "2"}], 
      "]"}], "+", 
     RowBox[{
      RowBox[{"Tr", "[", 
       RowBox[{"Grad", "[", 
        RowBox[{"U", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], "]"}], "^", 
      "2"}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.5"}], "#"}], "&"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"QQ1", "-", "QQ2"}], "//", "FullSimplify"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"QQ", "=", "QQ2"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Q", "-", "QQ"}], ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["u", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"3", ",", "x", ",", "y", ",", "z"}], "]"}], "->", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         SuperscriptBox["u", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"2", ",", "x", ",", "y", ",", "z"}], "]"}]}], "-", 
       RowBox[{
        SuperscriptBox["u", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"1", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], "}"}]}], "//",
    "FullSimplify"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Q = \>\"", ",", "Q"}], "]"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"R", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"eigenValueGradU", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], " ", "*", " ", 
      RowBox[{"eigenValueGradU", "[", 
       RowBox[{"[", "2", "]"}], "]"}], " ", "*", " ", 
      RowBox[{"eigenValueGradU", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], "//", "FullSimplify"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<R=-eigenValueGradU[[1]] * eigenValueGradU[[2]] * \
eigenValueGradU[[3]]\\n  = \>\"", ",", "R"}], "]"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{"uu", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ux", ",", " ", "uy", ",", " ", "uz"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"vx", ",", " ", "vy", ",", "vz"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"wx", ",", " ", "wy", ",", " ", "wz"}], "}"}]}], "}"}]}], 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.919741031333661*^9, 3.9197410936616087`*^9}, {
   3.91974151230049*^9, 3.9197415788973722`*^9}, {3.919741703785562*^9, 
   3.91974178669407*^9}, {3.9197418211117287`*^9, 3.919741970826626*^9}, {
   3.9197425800651484`*^9, 3.919742584988434*^9}, {3.919749254047076*^9, 
   3.919749306300959*^9}, {3.9198024173926497`*^9, 3.919802462430787*^9}, {
   3.919802509650857*^9, 3.919802583372101*^9}, {3.919802681526181*^9, 
   3.9198029417016277`*^9}, {3.91980298147896*^9, 3.91980302076234*^9}, {
   3.919803054738571*^9, 3.919803218942811*^9}, {3.9198086540698338`*^9, 
   3.919808756150393*^9}, {3.9198088318536873`*^9, 3.919809091223796*^9}, {
   3.919809245975721*^9, 3.919809286426051*^9}, {3.9198093231737137`*^9, 
   3.9198093404400806`*^9}, {3.919809390465727*^9, 3.919809608108197*^9}, 
   3.919810176335083*^9, {3.9198102204324102`*^9, 3.919810238285582*^9}, {
   3.919810296123761*^9, 3.9198103039853773`*^9}, {3.9198103390710583`*^9, 
   3.919810349518867*^9}, {3.9198104055534*^9, 3.919810647588217*^9}, {
   3.9198106923452663`*^9, 3.919810729769135*^9}},
 CellLabel->
  "In[6152]:=",ExpressionUUID->"db886a9e-41d4-42d9-83a1-675aeae76278"],

Cell[BoxData[
 RowBox[{"0.`", "\[VeryThinSpace]", "-", 
  RowBox[{"1.`", " ", 
   RowBox[{"u", "[", 
    RowBox[{"3", ",", "x", ",", "y", ",", "z"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox["u", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"3", ",", "x", ",", "y", ",", "z"}], "]"}]}], "+", 
  RowBox[{"0.5`", " ", 
   SuperscriptBox[
    RowBox[{
     SuperscriptBox["u", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"3", ",", "x", ",", "y", ",", "z"}], "]"}], "2"]}], "-", 
  RowBox[{"1.`", " ", 
   RowBox[{"u", "[", 
    RowBox[{"2", ",", "x", ",", "y", ",", "z"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox["u", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"2", ",", "x", ",", "y", ",", "z"}], "]"}]}], "+", 
  RowBox[{"0.5`", " ", 
   SuperscriptBox[
    RowBox[{
     SuperscriptBox["u", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"2", ",", "x", ",", "y", ",", "z"}], "]"}], "2"]}], "-", 
  RowBox[{"1.`", " ", 
   RowBox[{"u", "[", 
    RowBox[{"1", ",", "x", ",", "y", ",", "z"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox["u", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"1", ",", "x", ",", "y", ",", "z"}], "]"}]}], "+", 
  RowBox[{"0.5`", " ", 
   SuperscriptBox[
    RowBox[{
     SuperscriptBox["u", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"1", ",", "x", ",", "y", ",", "z"}], "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{{3.919810573942153*^9, 3.919810624854622*^9}, 
   3.919810657376186*^9, {3.919810697504239*^9, 3.919810730327075*^9}, {
   3.92285285256358*^9, 3.9228528759829197`*^9}},
 CellLabel->
  "Out[6160]=",ExpressionUUID->"c38b316e-f735-43d9-9d4a-3e59212c9850"],

Cell[BoxData[
 RowBox[{"0.`", "\[VeryThinSpace]", "-", 
  RowBox[{"1.`", " ", 
   RowBox[{
    SuperscriptBox["u", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"2", ",", "x", ",", "y", ",", "z"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox["u", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"3", ",", "x", ",", "y", ",", "z"}], "]"}]}], "-", 
  RowBox[{"1.`", " ", 
   RowBox[{
    SuperscriptBox["u", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"1", ",", "x", ",", "y", ",", "z"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox["u", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"2", ",", "x", ",", "y", ",", "z"}], "]"}]}], "-", 
  RowBox[{"1.`", " ", 
   RowBox[{
    SuperscriptBox["u", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"1", ",", "x", ",", "y", ",", "z"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox["u", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"3", ",", "x", ",", "y", ",", "z"}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.919810573942153*^9, 3.919810624854622*^9}, 
   3.919810657376186*^9, {3.919810697504239*^9, 3.919810730327075*^9}, {
   3.92285285256358*^9, 3.9228528759869623`*^9}},
 CellLabel->
  "Out[6162]=",ExpressionUUID->"7c210411-22c7-4688-a77f-f2592ba80fbc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"i", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", " ", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LocalSymbol", "[", 
   RowBox[{"\"\<f\>\"", "<>", 
    RowBox[{"ToString", "[", "i", "]"}], "<>", 
    RowBox[{"ToString", "[", "j", "]"}]}], "]"}], "=", 
  "5"}], "\[IndentingNewLine]", 
 RowBox[{"LocalSymbol", "[", "\"\<f11\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.9228526408888817`*^9, 3.922852713781131*^9}, {
  3.9228528307553453`*^9, 3.922852872009552*^9}, {3.9228529120378923`*^9, 
  3.922852921376286*^9}, {3.9228530250953493`*^9, 3.922853062915616*^9}},
 CellLabel->
  "In[6189]:=",ExpressionUUID->"ee29f855-369f-44af-8e5e-1f3e1d594364"],

Cell[BoxData["5"], "Output",
 CellChangeTimes->{
  3.922852714630616*^9, {3.922852839719109*^9, 3.9228528760572767`*^9}, 
   3.92285292180157*^9, {3.9228530264202023`*^9, 3.922853063426753*^9}},
 CellLabel->
  "Out[6192]=",ExpressionUUID->"506d7514-7a0f-4d97-8ba5-244962d7585f"],

Cell[BoxData["5"], "Output",
 CellChangeTimes->{
  3.922852714630616*^9, {3.922852839719109*^9, 3.9228528760572767`*^9}, 
   3.92285292180157*^9, {3.9228530264202023`*^9, 3.922853063434572*^9}},
 CellLabel->
  "Out[6193]=",ExpressionUUID->"529fab03-4b4d-4b5d-ab73-e7bd50440e9e"]
}, Open  ]]
},
WindowSize->{1616, 911},
WindowMargins->{{8, Automatic}, {Automatic, 36}},
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) \
(2021\:5e746\:670819\:65e5)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"55548f20-531d-457b-a587-15d04089626d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 6883, 193, 771, "Input",ExpressionUUID->"db886a9e-41d4-42d9-83a1-675aeae76278"],
Cell[7466, 217, 2321, 69, 34, "Output",ExpressionUUID->"c38b316e-f735-43d9-9d4a-3e59212c9850"],
Cell[9790, 288, 1892, 57, 34, "Output",ExpressionUUID->"7c210411-22c7-4688-a77f-f2592ba80fbc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11719, 350, 833, 19, 158, "Input",ExpressionUUID->"ee29f855-369f-44af-8e5e-1f3e1d594364"],
Cell[12555, 371, 278, 5, 34, "Output",ExpressionUUID->"506d7514-7a0f-4d97-8ba5-244962d7585f"],
Cell[12836, 378, 278, 5, 34, "Output",ExpressionUUID->"529fab03-4b4d-4b5d-ab73-e7bd50440e9e"]
}, Open  ]]
}
]
*)

